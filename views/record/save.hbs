<link href="/style/label.css" rel="stylesheet">
<style>

input:not(:checked)~span {
	background: #bbb !important;
}

input[type="checkbox"] {
	display:none;
}

label.tag-label {
	padding: 0;
	margin: 0;
}

</style>
<h1>Aufnahme abspeichern</h1>
<p>Hier kann eine Aufnahme abgespeichert werden. Bitte geben Sie eine Beschreibung an.</p>
<form class="form-horizontal">
	<div class="form-group">
		<label for="user" class="col-sm-2 control-label">Benutzer</label>
		<div class="col-sm-10">
			<div class="input-group">
				<span class="input-group-addon" id="basic-addon1"><i class="fa fa-user"></i></span>
				<input name="user" type="text" class="form-control" value="{{record.user.username}}" disabled>
			</div>
		</div>
	</div>
	<div class="form-group">
		<label for="time" class="col-sm-2 control-label">Zeitpunkt</label>
		<div class="col-sm-10">
			<div class="input-group">
				<span class="input-group-addon" id="basic-addon1"><i class="fa fa-clock-o"></i></span>
				<input name="time" type="text" class="form-control" value="{{formatDate record.date}} {{formatTime record.date}}" disabled>
			</div>
		</div>
	</div>
	<div class="form-group">
		<label for="description" class="col-sm-2 control-label">Benutzer</label>
		<div class="col-sm-10">
			<div class="input-group">
				<span class="input-group-addon" id="basic-addon1"><i class="fa fa-edit"></i></span>
				<textarea style="resize: none;" rows="3" name="description" class="form-control" id="description"></textarea>
			</div>
		</div>
	</div>
	<div class="form-group">
		<label class="col-sm-2 control-label">Tags</label>
		<div class="col-sm-10">
			{{#each labels}}
			<label class="checkbox-inline tag-label">
				<input type="checkbox" class="tag-checkbox">
				<span class="label" style="background: {{colorify this.name}};">{{this.name}}</span>
			</label>
			{{/each}}
		</div>
	</div>
	<div class="form-group">
		<label for="save" class="col-sm-2 control-label">Speichern</label>
		<div class="col-sm-10">
			<button class="btn btn-default" type="button" id="submit"><i class="fa fa-save"></i> Submit</button>
		</div>
	</div>
</form>
<script>
$("#submit").click(function() {
	var quote = encodeURI($("#description").val());
	$.ajax("/api/record/save?id={{record.id}}&quote=" + quote).done(function(res) {
		if(res.okay) {
			window.location.href = "/record/";
		}
	})
	.error(function() {
		spawnNotification('error', "Konnte Aufnahme nicht speichern.");
	});
});
</script>
